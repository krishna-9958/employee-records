<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:ee="http://www.mulesoft.org/schema/mule/ee/core" xmlns="http://www.mulesoft.org/schema/mule/core"
	xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/ee/core http://www.mulesoft.org/schema/mule/ee/core/current/mule-ee.xsd">
	<sub-flow name="errorSub_Flow" doc:id="40bbf8db-2554-4d75-95bd-5c7fac11c577" >
		<ee:transform doc:name="Transform Error Response Message" doc:id="e382028f-6fd3-40ce-8192-63b0e7b188f0" >
			<ee:message >
				<ee:set-payload ><![CDATA[%dw 2.0
output application/json
---
{
	transactionId: vars.transactionId,
	errorCode: vars.varErrorCode,
	errorMessage: vars.varErrorMessage,
	errorDescription: error.description,
	errorCreationTime: vars.varErrorTime
}]]></ee:set-payload>
			</ee:message>
		</ee:transform>
	</sub-flow>
	<error-handler name="global-apikit-error-handler" doc:id="3b9a9180-c963-4b89-84c9-5fa257e9ec6a" >
		<on-error-propagate enableNotifications="true" logException="true" doc:name="On Error Propagate" doc:id="934419e4-8600-4577-9066-f5e93ce689b6" type="APIKIT:BAD_REQUEST">
			<ee:transform doc:name="Initialize Error Variables" doc:id="0930d1f5-98e0-4110-83a6-be8f2d5b448a" >
				<ee:message >
				</ee:message>
				<ee:variables >
					<ee:set-variable variableName="httpStatus" ><![CDATA[400]]></ee:set-variable>
					<ee:set-variable variableName="varErrorType" ><![CDATA[%dw 2.0
output application/java
---
'Validation Error']]></ee:set-variable>
					<ee:set-variable variableName="varErrorCode" ><![CDATA[%dw 2.0
output application/java
---
'ERR-VALIDATION-1005']]></ee:set-variable>
					<ee:set-variable variableName="varErrorTime" ><![CDATA[%dw 2.0
output application/java
---
now()]]></ee:set-variable>
					<ee:set-variable variableName="varErrorMessage" ><![CDATA[%dw 2.0
output application/java
---
'Please check the input request body and url parameters']]></ee:set-variable>
				</ee:variables>
			</ee:transform>
			<logger level="INFO" doc:name="Log Initialized Error Attributes" doc:id="9bf0a975-2d56-42a1-8759-dff47fbbf2cb" message="================ errorType: #[vars.varErrorType] , errorMessage:  #[vars.varErrorMessage] , errorCode: #[vars.varErrorCode] ==================="/>
			<flow-ref doc:name="Flow Reference" doc:id="08d668de-627a-4d39-a67d-dae646943a07" name="errorSub_Flow"/>
		</on-error-propagate>
		<on-error-propagate enableNotifications="true" logException="true" doc:name="On Error Propagate" doc:id="b95446bb-ff81-4444-9eb2-c43c7850cbba" type="APIKIT:NOT_FOUND">
			<ee:transform doc:name="Transform Message" doc:id="d7dc9845-fd2b-4098-9601-a5171f26e8a3" >
				<ee:message >
				</ee:message>
				<ee:variables >
					<ee:set-variable variableName="varErrorMessage" ><![CDATA[%dw 2.0
output application/java
---
'URL not found, Please check the URL and format']]></ee:set-variable>
					<ee:set-variable variableName="httpStatus" ><![CDATA[404]]></ee:set-variable>
					<ee:set-variable variableName="varErrorType" ><![CDATA[%dw 2.0
output application/java
---
'Validation Error']]></ee:set-variable>
					<ee:set-variable variableName="varErrorCode" ><![CDATA[%dw 2.0
output application/java
---
'ERR-VALIDATION-1001']]></ee:set-variable>
					<ee:set-variable variableName="varErrorTime" ><![CDATA[%dw 2.0
output application/java
---
now()]]></ee:set-variable>
				</ee:variables>
			</ee:transform>
			<logger level="INFO" doc:name="Log Initialized Error Attributes" doc:id="6d230348-9567-4fd7-b991-820ba166c1c8" message="================ errorType: #[vars.varErrorType] , errorMessage:  #[vars.varErrorMessage] , errorCode: #[vars.varErrorCode] ==================="/>
			<flow-ref doc:name="Flow Reference" doc:id="7da11c9f-8a3f-4e9b-8f74-a6fedf472b24" name="errorSub_Flow"/>
		</on-error-propagate>
		<on-error-propagate enableNotifications="true" logException="true" doc:name="On Error Propagate" doc:id="3700fe9b-2150-4b99-a91f-1d492e65f87d" type="APIKIT:METHOD_NOT_ALLOWED">
			<ee:transform doc:name="Initialize Error Variables"
				doc:id="8bf0f890-b89c-4074-81f0-b3095ea77dfe">
				<ee:message>
				</ee:message>
				<ee:variables>
					<ee:set-variable variableName="varErrorMessage"><![CDATA[%dw 2.0
output application/java
---
'Method not allowed, Please check the HTTP/HTTPS method in request']]></ee:set-variable>
					<ee:set-variable variableName="varErrorCode"><![CDATA[%dw 2.0
output application/java
---
'ERR-VALIDATION-1002']]></ee:set-variable>
					<ee:set-variable variableName="varErrorType"><![CDATA[%dw 2.0
output application/java
---
'Validation Error']]></ee:set-variable>
					<ee:set-variable variableName="httpStatus"><![CDATA[405]]></ee:set-variable>
				</ee:variables>
			</ee:transform>
			<logger level="INFO" doc:name="Log Initialized Error Attributes" doc:id="00ed751f-f139-4702-af37-aa06476fc72c" message="================ errorType: #[vars.varErrorType] , errorMessage:  #[vars.varErrorMessage] , errorCode: #[vars.varErrorCode] ==================="/>
			<flow-ref doc:name="Flow Reference" doc:id="2d3b9dd1-5454-4dc2-a429-d0ce4b257be1" name="errorSub_Flow"/>
		</on-error-propagate>
		<on-error-propagate enableNotifications="true" logException="true" doc:name="On Error Propagate" doc:id="d2cc63b3-c4f5-44cc-bda3-814d413a425e" type="APIKIT:NOT_ACCEPTABLE">
			<ee:transform doc:name="Initialize Error Variables"
				doc:id="f2edd961-1dbc-4cc1-af01-af3bfd58c6eb">
				<ee:message>
				</ee:message>
				<ee:variables>
					<ee:set-variable variableName="varErrorMessage"><![CDATA[%dw 2.0
output application/java
---
'Please check the expected response format']]></ee:set-variable>
					<ee:set-variable variableName="varErrorCode"><![CDATA[%dw 2.0
output application/java
---
'ERR-VALIDATION-1004']]></ee:set-variable>
					<ee:set-variable variableName="varErrorType"><![CDATA[%dw 2.0
output application/java
---
'Validation Error']]></ee:set-variable>
					<ee:set-variable variableName="httpStatus"><![CDATA[406]]></ee:set-variable>
				</ee:variables>
			</ee:transform>
			<logger level="INFO" doc:name="Log Initialized Error Attributes" doc:id="5c18b51d-0a9b-4068-98a9-8d3b910454b8" message="================ errorType: #[vars.varErrorType] , errorMessage:  #[vars.varErrorMessage] , errorCode: #[vars.varErrorCode] ==================="/>
			<flow-ref doc:name="Flow Reference" doc:id="a8abfaf2-886a-46af-ac2e-90930a6824da" name="errorSub_Flow"/>
		</on-error-propagate>
		<on-error-propagate enableNotifications="true" logException="true" doc:name="On Error Propagate" doc:id="af270bb7-e3f6-42f0-9326-610ae54efd79" type="APIKIT:UNSUPPORTED_MEDIA_TYPE">
			<ee:transform doc:name="Initialize Error Variables"
				doc:id="bc4310f1-5d84-48dc-8807-cc9d308ec68d">
				<ee:message>
				</ee:message>
				<ee:variables>
					<ee:set-variable variableName="varErrorMessage"><![CDATA[%dw 2.0
output application/java
---
'Please check the Content-Type or Content-Encoding for this request']]></ee:set-variable>
					<ee:set-variable variableName="varErrorCode"><![CDATA[%dw 2.0
output application/java
---
'ERR-VALIDATION-1003']]></ee:set-variable>
					<ee:set-variable variableName="varErrorType"><![CDATA[%dw 2.0
output application/java
---
'Validation Error']]></ee:set-variable>
					<ee:set-variable variableName="httpStatus"><![CDATA[415]]></ee:set-variable>
				</ee:variables>
			</ee:transform>
			<logger level="INFO" doc:name="Log Initialized Error Attributes" doc:id="a2520844-e46f-43ae-aeef-9bbefe483a25" message="================ errorType: #[vars.varErrorType] , errorMessage:  #[vars.varErrorMessage] , errorCode: #[vars.varErrorCode] ==================="/>
			<flow-ref doc:name="Flow Reference" doc:id="46dc4fb8-1344-4393-9a7a-641888ea471b" name="errorSub_Flow"/>
		</on-error-propagate>
		<on-error-propagate enableNotifications="true" logException="true" doc:name="On Error Propagate" doc:id="617b52fa-6e71-4b69-adbd-cf724dd1171b" type="APIKIT:NOT_IMPLEMENTED">
			<ee:transform doc:name="Initialize Error Variables"
				doc:id="f338b89a-eff2-454f-b982-fd5d59ac576b">
				<ee:message>
				</ee:message>
				<ee:variables>
					<ee:set-variable variableName="varErrorMessage"><![CDATA[%dw 2.0
output application/java
---
'Please check the request methods supported by the server.']]></ee:set-variable>
					<ee:set-variable variableName="varErrorCode"><![CDATA[%dw 2.0
output application/java
---
'ERR-VALIDATION-1006']]></ee:set-variable>
					<ee:set-variable variableName="varErrorType"><![CDATA[%dw 2.0
output application/java
---
'Validation Error']]></ee:set-variable>
					<ee:set-variable variableName="httpStatus"><![CDATA[501]]></ee:set-variable>
				</ee:variables>
			</ee:transform>
			<logger level="INFO" doc:name="Log Initialized Error Attributes" doc:id="39f80266-169e-4575-9fab-1003f30c4099" message="================ errorType: #[vars.varErrorType] , errorMessage:  #[vars.varErrorMessage] , errorCode: #[vars.varErrorCode] ==================="/>
			<flow-ref doc:name="Flow Reference" doc:id="6f6a0453-9882-4d4b-8bce-cc163c7b4ae4" name="errorSub_Flow"/>
		</on-error-propagate>
		<on-error-propagate enableNotifications="true" logException="true" doc:name="On Error Propagate" doc:id="d815a46d-6912-471d-bbc4-8998b3dba5df" type="APIKIT:ANY">
			<ee:transform doc:name="Initialize Error Variables"
				doc:id="0379d19d-a28d-4c48-84f6-bb83a5af90b4">
				<ee:message>
				</ee:message>
				<ee:variables>
					<ee:set-variable variableName="varErrorMessage"><![CDATA[%dw 2.0
output application/java
---
'An unexpected exception occurred. Please refer the error description or contact Mule API support team with transactionId for further information and resolution']]></ee:set-variable>
					<ee:set-variable variableName="varErrorCode"><![CDATA[%dw 2.0
output application/java
---
'ERR-VALIDATION-9999']]></ee:set-variable>
					<ee:set-variable variableName="varErrorType"><![CDATA[%dw 2.0
output application/java
---
'Validation Error']]></ee:set-variable>
					<ee:set-variable variableName="httpStatus"><![CDATA[500]]></ee:set-variable>
				</ee:variables>
			</ee:transform>
			<logger level="INFO" doc:name="Log Initialized Error Attributes" doc:id="876899ef-4472-47f0-b677-bf732a89cc88" message="================ errorType: #[vars.varErrorType] , errorMessage:  #[vars.varErrorMessage] , errorCode: #[vars.varErrorCode] ==================="/>
			<flow-ref doc:name="Flow Reference" doc:id="d1733dca-70b3-4d0b-b792-6e713f2e589c" name="errorSub_Flow"/>
		</on-error-propagate>
	</error-handler>
</mule>
